<!DOCTYPE html>
<html>
<head>
<title>Iris Flower Classification</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

body {
    font-family: 'Roboto', Arial, sans-serif;
    background: linear-gradient(to right, #4e73df, #1cc88a);
    margin: 0;
    min-height: 100vh;
}

/* Container */
.container {
    width: 90%;
    max-width: 1400px;
    margin: 40px auto;
    display: flex;
    gap: 30px;
    flex-wrap: wrap;
}

/* Left Column */
.left-column {
    flex: 1;
    min-width: 300px;
    background: white;
    padding: 30px;
    border-radius: 16px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    text-align: center;
    transition: transform 0.3s;
}
.left-column:hover {
    transform: translateY(-5px);
}

.left-column h2 {
    color: #1cc88a;
    font-size: 36px;
    margin-bottom: 25px;
}

/* Input fields with icons */
.input-group {
    position: relative;
    margin: 15px 0;
}

.input-group i {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #4e73df;
}

input[type="number"] {
    padding: 12px 12px 12px 36px;
    width: 80%;
    border-radius: 10px;
    border: 1px solid #ccc;
    font-size: 16px;
}

/* Model selection */
.model-selection {
    margin: 20px 0;
    display: flex;
    justify-content: center;
    gap: 20px;
    font-size: 16px;
}
.model-selection label {
    display: flex;
    align-items: center;
    gap: 6px;
    font-weight: bold;
    cursor: pointer;
}

/* Predict Button */
button.predict {
    background: linear-gradient(45deg, #4e73df, #1cc88a);
    color: white;
    width: 60%;
    padding: 12px 0;
    border-radius: 50px;
    font-size: 18px;
    font-weight: bold;
    border: none;
    cursor: pointer;
    transition: transform 0.3s, box-shadow 0.3s;
}
button.predict:hover {
    transform: scale(1.05);
    box-shadow: 0 5px 20px rgba(0,0,0,0.3);
}

/* Right Column */
.right-column {
    flex: 2;
    min-width: 350px;
    background: white;
    padding: 30px;
    border-radius: 16px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    max-height: 90vh;
    overflow-y: auto;
    transition: transform 0.3s, opacity 0.3s;
    opacity: 0;
    display: none; /* hidden initially */
}
.right-column.visible {
    display: block;
    opacity: 1;
}
.right-column:hover {
    transform: translateY(-5px);
}

.right-column h2 {
    text-align: center;
    font-size: 36px;
    margin-bottom: 25px;
}

/* Prediction */
#prediction {
    font-weight: bold;
    font-size: 24px;
    text-align: center;
    margin-bottom: 25px;
    color: #ff99cc; /* light pink */
}

/* Section headings */
.section h3.train-test-heading {
    color: #28a745;
    font-weight: bold;
    font-size: 22px;
    margin-top: 25px;
    margin-bottom: 12px;
}

/* Accuracy label and value */
.section b {
    color: #4e73df; /* now blue */
    font-weight: bold;
    font-size: 18px;
}
.result-value {
    font-weight: bold;
    font-size: 18px;
}

/* Accuracy coloring */
.result-value.green { color: #28a745; }
.result-value.yellow { color: #ffc107; }
.result-value.red { color: #dc3545; }

/* Confusion Matrix & Classification Report Headings */
.result-heading {
    font-size: 18px;
    color: #4e73df;
    font-weight: bold;
    margin-top: 15px;
    margin-bottom: 8px;
}

/* Table styling */
table {
    border-collapse: collapse;
    margin-top: 10px;
    width: 70%;
    margin-left: auto;
    margin-right: auto;
    background: #e9f0ff;
    border-radius: 8px;
    overflow: hidden;
}

td {
    border: 1px solid #4e73df;
    padding: 10px;
    text-align: center;
    font-weight: bold;
    color: #4e73df;
}

/* Classification Report */
pre {
    background: #e9f0ff;
    padding: 15px;
    color: #4e73df;
    font-weight: bold;
    white-space: pre-wrap;
    border-radius: 10px;
}

/* Responsive */
@media (max-width: 900px) {
    .container { flex-direction: column; align-items: center; }
    input[type="number"] { width: 90%; }
    button.predict { width: 70%; }
    table { width: 90%; }
}
</style>
</head>

<body>

<div class="container">

<!-- Left Column -->
<div class="left-column">
    <h2><i class="fas fa-seedling"></i> Iris Classifier</h2>

    <div class="input-group">
        <i class="fas fa-ruler-vertical"></i>
        <input id="sl" type="number" placeholder="Sepal Length">
    </div>
    <div class="input-group">
        <i class="fas fa-ruler-horizontal"></i>
        <input id="sw" type="number" placeholder="Sepal Width">
    </div>
    <div class="input-group">
        <i class="fas fa-pencil-alt"></i>
        <input id="pl" type="number" placeholder="Petal Length">
    </div>
    <div class="input-group">
        <i class="fas fa-pencil-ruler"></i>
        <input id="pw" type="number" placeholder="Petal Width">
    </div>

    <!-- Model selection -->
    <div class="model-selection">
        <label><input type="radio" name="model" value="knn" checked> KNN</label>
        <label><input type="radio" name="model" value="nb"> Naive Bayes</label>
    </div>

    <!-- Predict Button -->
    <button class="predict" onclick="predict()"><i class="fas fa-play"></i> Predict</button>
</div>

<!-- Right Column -->
<div class="right-column" id="resultsPanel">
    <h2><i class="fas fa-chart-line"></i> Results</h2>
    <p id="prediction">Predicted Flower: </p>

    <div class="section">
        <h3 class="train-test-heading">Train Results</h3>
        <p><b>Accuracy:</b> <span class="result-value" id="trainAcc"></span></p>
        <div class="result-heading">Confusion Matrix</div>
        <div id="trainCM"></div>
        <div class="result-heading">Classification Report</div>
        <pre id="trainReport"></pre>
    </div>

    <div class="section">
        <h3 class="train-test-heading">Test Results</h3>
        <p><b>Accuracy:</b> <span class="result-value" id="testAcc"></span></p>
        <div class="result-heading">Confusion Matrix</div>
        <div id="testCM"></div>
        <div class="result-heading">Classification Report</div>
        <pre id="testReport"></pre>
    </div>
</div>

</div>

<script>
function createMatrix(matrix) {
    let table = "<table>";
    for (let i = 0; i < matrix.length; i++) {
        table += "<tr>";
        for (let j = 0; j < matrix[i].length; j++) {
            table += "<td>" + matrix[i][j] + "</td>";
        }
        table += "</tr>";
    }
    table += "</table>";
    return table;
}

// Function to color accuracy
function colorAccuracy(value, elementId) {
    let el = document.getElementById(elementId);
    el.classList.remove("green", "yellow", "red");
    let acc = parseFloat(value);
    if (acc >= 90) el.classList.add("green");
    else if (acc >= 70) el.classList.add("yellow");
    else el.classList.add("red");
    el.innerText = value + "%";
}

function predict() {
    let modelType = document.querySelector('input[name="model"]:checked').value;

    fetch("/predict", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({
            sl: document.getElementById("sl").value,
            sw: document.getElementById("sw").value,
            pl: document.getElementById("pl").value,
            pw: document.getElementById("pw").value,
            model: modelType
        })
    })
    .then(res => res.json())
    .then(data => {
        // Show right panel
        document.getElementById("resultsPanel").classList.add("visible");

        document.getElementById("prediction").innerText =
            "Predicted Flower: " + data.prediction;

        colorAccuracy(data.train_results.accuracy, "trainAcc");
        document.getElementById("trainCM").innerHTML =
            createMatrix(data.train_results.confusion_matrix);
        document.getElementById("trainReport").innerText =
            data.train_results.classification_report;

        colorAccuracy(data.test_results.accuracy, "testAcc");
        document.getElementById("testCM").innerHTML =
            createMatrix(data.test_results.confusion_matrix);
        document.getElementById("testReport").innerText =
            data.test_results.classification_report;
    });
}
</script>

</body>
</html>